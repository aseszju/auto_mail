# ASES_AUTO_MAIL ASES自动邮件群发机
## 简介
本小程序使用python2.7编写，使用了若干第三方库：`email`,`smtplib`,`xlrd`,`ConfigParser`。建议未来的小伙伴将程序搬到ASES服务器上，以B/S软件的形式面向非程序员人士使用。
## 功能简介
支持通过excel导入收件人名称和收件地址，支持自动替换邮件内容中的姓名，支持自带附件，实现批量化高效群发。
### 替换称呼
要注意的是，如果要实现对名称的自动替换，要在配置中将`name_flag`设置为`True`(默认为`False`）必须在邮件内容文件中使用`$name`来表示名称。
比如,如果要实现对信件开头的称呼的替换
```
Dear [姓名]:
	Nice to meet you!
	See you again!
zahgboat
```
需要以如下形式存在`TXT_FILE`文件中
```
Dear $name:
	Nice to meet you!
	See you again!
zahgboat
```
### 收件人EXCEL文件
目前程序仅支持{称呼:地址}的EXCEL格式。即第一列为收件人称呼，第二列为对应的收件人地址。

### 附件
需要传送的附件统一放置在附件文件夹中，程序会自动把文件夹中所有文件作为附件传送。

## 配置介绍
相关配置在`config.ini`文件中 按需要进行修改即可
以下是可支持的选项：
`发件邮箱`,`邮箱密码`,`smtp服务器地址`,`smtp服务器端口`,`邮件标题`,`是否需要替换人名`,`邮件内容`，`附件文件夹`，`发件人列表文件`

## 程序限制
首先程序目前仅支持称呼的自动替换。有兴趣扩展它的小伙伴可以参考python的字符串模板功能扩充源程序。
其次程序的发送效率并不高，并且受运行时网络环境的限制。源程序中设计了一定的异常处理，当出现网络异常时会连续尝试5次。当5次尝试全都失败后，程序会报错，输出之前已经发送成功的总数、邮件地址和称呼。之后只要修改收件人列表，将发送成功的收件人行删除，让列表从发送失败的那一行收件人开始即可。


